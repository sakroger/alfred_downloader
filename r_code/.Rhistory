real_date_late <- dates_to_download[a+1]
fred_data_url <- paste0('https://fred.stlouisfed.org/graph/fredgraph.csv?cosd=',real_date_early,'&coed=',real_date_late,'&realtime_start=',real_date_early,'&realtime_end=',real_date_late,'&id=',fred_id)
if (is.na(real_date_late))
{
}
else
{
download.file(fred_data_url, fred_data_filename, method = 'auto', quiet = 'FALSE', mode="a")
}
}
{
real_date_early <- dates_to_download[a]
real_date_late <- dates_to_download[a+1]
fred_data_url <- paste0('https://fred.stlouisfed.org/graph/fredgraph.csv?cosd=',real_date_early,'&coed=',real_date_late,'&realtime_start=',real_date_early,'&realtime_end=',real_date_late,'&id=',fred_id)
if (is.na(real_date_late))
{
}
else
{
download.file(fred_data_url, fred_data_filename, method = 'auto', quiet = 'FALSE', mode="w")
}
}
for (a in 1:number_of_dates)
download_loop_fred_csv <- function()
{
dates_to_download <- release_dates()
number_of_dates <- length(dates_to_download)
for (a in 1:number_of_dates)
{
real_date_early <- dates_to_download[a]
real_date_late <- dates_to_download[a+1]
fred_data_url <- paste0('https://fred.stlouisfed.org/graph/fredgraph.csv?cosd=',real_date_early,'&coed=',real_date_late,'&realtime_start=',real_date_early,'&realtime_end=',real_date_late,'&id=',fred_id)
if (is.na(real_date_late))
{
}
else
{
download.file(fred_data_url, fred_data_filename, method = 'auto', quiet = 'FALSE', mode="w")
}
}
}
d=
}
for (a in 1:number_of_dates)
{
real_date_early <- dates_to_download[a]
real_date_late <- dates_to_download[a+1]
fred_data_url <- paste0('https://fred.stlouisfed.org/graph/fredgraph.csv?cosd=',real_date_early,'&coed=',real_date_late,'&realtime_start=',real_date_early,'&realtime_end=',real_date_late,'&id=',fred_id)
if (is.na(real_date_late))
{
}
else
{
download.file(fred_data_url, fred_data_filename, method = 'auto', quiet = 'FALSE', mode="w")
}
}
for (a in 1:number_of_dates)
{
real_date_early <- dates_to_download[a]
real_date_late <- dates_to_download[a+1]
fred_data_url <- paste0('https://fred.stlouisfed.org/graph/fredgraph.csv?cosd=',real_date_early,'&coed=',real_date_late,'&realtime_start=',real_date_early,'&realtime_end=',real_date_late,'&id=',fred_id)
if (is.na(real_date_late))
{
}
else
{
download.file(fred_data_url, fred_data_filename)
}
}
download_loop_fred_csv <- function()
{
dates_to_download <- release_dates()
number_of_dates <- length(dates_to_download)
for (a in 1:number_of_dates)
{
real_date_early <- dates_to_download[a]
real_date_late <- dates_to_download[a+1]
fred_data_url <- paste0('https://fred.stlouisfed.org/graph/fredgraph.csv?cosd=',real_date_early,'&coed=',real_date_late,'&realtime_start=',real_date_early,'&realtime_end=',real_date_late,'&id=',fred_id)
if (is.na(real_date_late))
{
}
else
{
download.file(fred_data_url, fred_data_filename)
}
}
}
for (a in 1:number_of_dates)
{
real_date_early <- dates_to_download[a]
real_date_late <- dates_to_download[a+1]
fred_data_url <- paste0('https://fred.stlouisfed.org/graph/fredgraph.csv?cosd=',real_date_early,'&coed=',real_date_late,'&realtime_start=',real_date_early,'&realtime_end=',real_date_late,'&id=',fred_id)
#if (is.na(real_date_late))
#  {
# }
#else
# {
download.file(fred_data_url, fred_data_filename)
#}
}
for (a in 1:number_of_dates)
{
real_date_early <- dates_to_download[a]
real_date_late <- dates_to_download[a+1]
fred_data_url <- paste0('https://fred.stlouisfed.org/graph/fredgraph.csv?cosd=',real_date_early,'&coed=',real_date_late,'&realtime_start=',real_date_early,'&realtime_end=',real_date_late,'&id=',fred_id)
if (is.na(real_date_late))
{
}
else
{
download.file(fred_data_url, fred_data_filename, quiet = FALSE, mode = 'a')
}
}
library(fred)
library(readr)
library(RODBC)
library(httr)
library(jsonlite)
sql_sign_in_info <- 'driver={SQL Server};server=desktop-m9e5cke;database=fred_stuff;uid=sakroger;pwd=123'
download_path <-  'C:\\Users\\sakro\\Desktop\\derek\\fred-master\\fred_csv\\'
fred_id_list <- c('T10YIE', 'FEDFUNDS', 'T10Y2Y')
for (fred_id in fred_id_list)
{
fred_data_filename <- paste0(download_path, fred_id,'.csv')
#dbconn <- get_connection()
title <- get_title_for_db()
download_loop_fred_csv()
data <- format_fred_csv(fred_data_filename)
#sql <- paste0('TRUNCATE TABLE [', title,' temp]')
#sql_query(sql)
varTypes <- list(dt = 'Date', title = 'float')
#RODBC::sqlSave(dbconn, data, tablename = paste0(title,' temp'),rownames=FALSE, append = T, fast=T, varTypes = varTypes)
#sql = paste0('delete a from [',title,'] a inner join [',title,' temp] b on a.dt=b.dt;insert into [',title,'] select * from [',title,' temp] ;truncate table [',title,' temp];')
#sql_query(sql)
#RODBC::odbcClose(dbconn)
}
real_date_early <- '2000-01-01'
real_date_late <- '2019-01-01'
fred_data_url <- paste0('https://fred.stlouisfed.org/graph/fredgraph.csv?cosd=',real_date_early,'&coed=',real_date_late,'&realtime_start=',real_date_early,'&realtime_end=',real_date_late,'&id=',fred_id)
fred_data_url
library(fred)
library(readr)
library(RODBC)
library(httr)
library(jsonlite)
sql_sign_in_info <- 'driver={SQL Server};server=desktop-m9e5cke;database=fred_stuff;uid=sakroger;pwd=123'
download_path <-  'C:\\Users\\sakro\\Desktop\\derek\\fred-master\\fred_csv\\'
('T10YIE')
fred_id_list <- c('T10YIE')
for (fred_id in fred_id_list)
{
fred_data_filename <- paste0(download_path, fred_id,'.csv')
#dbconn <- get_connection()
title <- get_title_for_db()
download_loop_fred_csv()
data <- format_fred_csv(fred_data_filename)
#sql <- paste0('TRUNCATE TABLE [', title,' temp]')
#sql_query(sql)
varTypes <- list(dt = 'Date', title = 'float')
#RODBC::sqlSave(dbconn, data, tablename = paste0(title,' temp'),rownames=FALSE, append = T, fast=T, varTypes = varTypes)
#sql = paste0('delete a from [',title,'] a inner join [',title,' temp] b on a.dt=b.dt;insert into [',title,'] select * from [',title,' temp] ;truncate table [',title,' temp];')
#sql_query(sql)
#RODBC::odbcClose(dbconn)
}
fred_data_filename
file<- fred_data_filename
file <- readr::read_csv(file)
title <- get_title_for_db()
View(file)
library(fred)
library(fred)
library(readr)
library(RODBC)
library(jsonlite)
sql_sign_in_info <- 'driver={SQL Server};server=desktop-m9e5cke;database=fred_stuff;uid=sakroger;pwd=123'
library(httr)
download_path <-  'C:\\Users\\sakro\\Desktop\\derek\\fred-master\\fred_csv\\'
fred_id_list <- c('T10YIE', 'FEDFUNDS', 'T10Y2Y')
fred_id_list <- c('T10YIE')
for (fred_id in fred_id_list)
{
fred_data_filename <- paste0(download_path, fred_id,'.csv')
#dbconn <- get_connection()
title <- get_title_for_db()
download_loop_fred_csv()
data <- format_fred_csv(fred_data_filename)
#sql <- paste0('TRUNCATE TABLE [', title,' temp]')
#sql_query(sql)
varTypes <- list(dt = 'Date', title = 'float')
#RODBC::sqlSave(dbconn, data, tablename = paste0(title,' temp'),rownames=FALSE, append = T, fast=T, varTypes = varTypes)
#sql = paste0('delete a from [',title,'] a inner join [',title,' temp] b on a.dt=b.dt;insert into [',title,'] select * from [',title,' temp] ;truncate table [',title,' temp];')
#sql_query(sql)
#RODBC::odbcClose(dbconn)
}
file <- fred_data_filename
file <- readr::read_csv(file)
View(file)
title <- get_title_for_db()
names(file) <- c('col1','col2')
file $col2 <- as.numeric(file$col2)
View(file)
names(file) <- c('dt',paste(title))
file <- file[complete.cases(file),]
View(data)
View(data)
View(file)
result <- tsQuery(sprintf("DROP TABLE IF EXISTS %s",tempTableName))
varTypes <- list(dt = 'Date')
varTypes[[fredId]] <- 'float'
View(data)
varTypes <- list(dt = 'Date')
varTypes[[title]] <- 'float'
View(varTypes)
library(fred)
library(readr)
library(RODBC)
library(httr)
library(jsonlite)
library(fred)
library(fred)
library(readr)
library(RODBC)
library(httr)
library(jsonlite)
sql_sign_in_info <- 'driver={SQL Server};server=desktop-m9e5cke;database=fred_stuff;uid=sakroger;pwd=123'
download_path <-  'C:\\Users\\sakro\\Desktop\\derek\\fred-master\\fred_csv\\'
fred_id_list <- c('T10YIE', 'FEDFUNDS', 'T10Y2Y')
dbconn <- get_connection()
for (fred_id in fred_id_list)
{
fred_data_filename <- paste0(download_path, fred_id,'.csv')
title <- get_title_for_db()
download_loop_fred_csv()
data <- format_fred_csv(fred_data_filename)
#result <- sql_query(sprintf("DROP TABLE IF EXISTS %s",tempTableName))
varTypes <- list(dt = 'Date')
varTypes[[title]] <- 'float'
#if (table_exists)
#  {
#
#   RODBC::sqlSave(dbconn, data, tablename = tempTableName, rownames=FALSE, append = T, fast=T, varTypes = varTypes)
#  RODBC::odbcClose(dbconn)
#
#   sql = sprintf('delete a from %s a inner join %s b on a.dt=b.dt;
#                insert into %s select * from %s;
#               drop table %s;',tableName, tempTableName, tableName, tempTableName, tempTableName)
#result<-sql_query(sql)
#}
#else
#{
#
#  RODBC::sqlSave(dbconn, data, tablename = tableName, rownames=FALSE, append = F, fast=T, varTypes = varTypes)
#  RODBC::odbcClose(dbconn)
#  sql = sprintf('ALTER TABLE %s ADD  CONSTRAINT PK_%s PRIMARY KEY CLUSTERED ([dt] ASC ) WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]',
#                tableName, fredId)
#  result<-sql_query(sql)
#  }
#sql <- paste0('TRUNCATE TABLE [', title,' temp]')
#sql_query(sql)
varTypes <- list(dt = 'Date', title = 'float')
#RODBC::sqlSave(dbconn, data, tablename = paste0(title,' temp'),rownames=FALSE, append = T, fast=T, varTypes = varTypes)
#sql = paste0('delete a from [',title,'] a inner join [',title,' temp] b on a.dt=b.dt;insert into [',title,'] select * from [',title,' temp] ;truncate table [',title,' temp];')
#sql_query(sql)
#RODBC::odbcClose(dbconn)
}
file.remove(fred_data_filename)
file.remove(fred_data_filename)
library(fred)
library(readr)
library(RODBC)
library(httr)
library(jsonlite)
sql_sign_in_info <- 'driver={SQL Server};server=desktop-m9e5cke;database=fred_stuff;uid=sakroger;pwd=123'
download_path <-  'C:\\Users\\sakro\\Desktop\\derek\\fred-master\\fred_csv\\'
fred_id_list <- c('T10YIE', 'FEDFUNDS', 'T10Y2Y')
dbconn <- get_connection()
for (fred_id in fred_id_list)
{
fred_data_filename <- paste0(download_path, fred_id,'.csv')
title <- get_title_for_db()
file.remove(fred_data_filename)
download_loop_fred_csv()
data <- format_fred_csv(fred_data_filename)
#result <- sql_query(sprintf("DROP TABLE IF EXISTS %s",tempTableName))
varTypes <- list(dt = 'Date')
varTypes[[title]] <- 'float'
#if (table_exists)
#  {
#
#   RODBC::sqlSave(dbconn, data, tablename = tempTableName, rownames=FALSE, append = T, fast=T, varTypes = varTypes)
#  RODBC::odbcClose(dbconn)
#
#   sql = sprintf('delete a from %s a inner join %s b on a.dt=b.dt;
#                insert into %s select * from %s;
#               drop table %s;',tableName, tempTableName, tableName, tempTableName, tempTableName)
#result<-sql_query(sql)
#}
#else
#{
#
#  RODBC::sqlSave(dbconn, data, tablename = tableName, rownames=FALSE, append = F, fast=T, varTypes = varTypes)
#  RODBC::odbcClose(dbconn)
#  sql = sprintf('ALTER TABLE %s ADD  CONSTRAINT PK_%s PRIMARY KEY CLUSTERED ([dt] ASC ) WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]',
#                tableName, fredId)
#  result<-sql_query(sql)
#  }
#sql <- paste0('TRUNCATE TABLE [', title,' temp]')
#sql_query(sql)
varTypes <- list(dt = 'Date', title = 'float')
#RODBC::sqlSave(dbconn, data, tablename = paste0(title,' temp'),rownames=FALSE, append = T, fast=T, varTypes = varTypes)
#sql = paste0('delete a from [',title,'] a inner join [',title,' temp] b on a.dt=b.dt;insert into [',title,'] select * from [',title,' temp] ;truncate table [',title,' temp];')
#sql_query(sql)
#RODBC::odbcClose(dbconn)
}
library(fred)
library(readr)
library(RODBC)
library(httr)
library(jsonlite)
sql_sign_in_info <- 'driver={SQL Server};server=desktop-m9e5cke;database=fred_stuff;uid=sakroger;pwd=123'
download_path <-  'C:\\Users\\sakro\\Desktop\\derek\\fred-master\\fred_csv\\'
fred_id_list <- c('T10YIE', 'FEDFUNDS', 'T10Y2Y')
for (fred_id in fred_id_list)
{
fred_data_filename <- paste0(download_path, fred_id,'.csv')
title <- get_title_for_db()
file.remove(fred_data_filename)
download_loop_fred_csv()
data <- format_fred_csv(fred_data_filename)
#result <- sql_query(sprintf("DROP TABLE IF EXISTS %s",tempTableName))
varTypes <- list(dt = 'Date')
varTypes[[title]] <- 'float'
#if (table_exists)
#  {
#
#   RODBC::sqlSave(dbconn, data, tablename = tempTableName, rownames=FALSE, append = T, fast=T, varTypes = varTypes)
#  RODBC::odbcClose(dbconn)
#
#   sql = sprintf('delete a from %s a inner join %s b on a.dt=b.dt;
#                insert into %s select * from %s;
#               drop table %s;',tableName, tempTableName, tableName, tempTableName, tempTableName)
#result<-sql_query(sql)
#}
#else
#{
#
#  RODBC::sqlSave(dbconn, data, tablename = tableName, rownames=FALSE, append = F, fast=T, varTypes = varTypes)
#  RODBC::odbcClose(dbconn)
#  sql = sprintf('ALTER TABLE %s ADD  CONSTRAINT PK_%s PRIMARY KEY CLUSTERED ([dt] ASC ) WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]',
#                tableName, fredId)
#  result<-sql_query(sql)
#  }
#sql <- paste0('TRUNCATE TABLE [', title,' temp]')
#sql_query(sql)
varTypes <- list(dt = 'Date', title = 'float')
#RODBC::sqlSave(dbconn, data, tablename = paste0(title,' temp'),rownames=FALSE, append = T, fast=T, varTypes = varTypes)
#sql = paste0('delete a from [',title,'] a inner join [',title,' temp] b on a.dt=b.dt;insert into [',title,'] select * from [',title,' temp] ;truncate table [',title,' temp];')
#sql_query(sql)
#RODBC::odbcClose(dbconn)
}
for (fred_id in fred_id_list)
{
fred_data_filename <- paste0(download_path, fred_id,'.csv')
title <- get_title_for_db()
file.remove(fred_data_filename)
download_loop_fred_csv()
data <- format_fred_csv(fred_data_filename)
#result <- sql_query(sprintf("DROP TABLE IF EXISTS %s",tempTableName))
varTypes <- list(dt = 'Date')
varTypes[[title]] <- 'float'
#if (table_exists)
#  {
#
#   RODBC::sqlSave(dbconn, data, tablename = tempTableName, rownames=FALSE, append = T, fast=T, varTypes = varTypes)
#  RODBC::odbcClose(dbconn)
#
#   sql = sprintf('delete a from %s a inner join %s b on a.dt=b.dt;
#                insert into %s select * from %s;
#               drop table %s;',tableName, tempTableName, tableName, tempTableName, tempTableName)
#result<-sql_query(sql)
#}
#else
#{
#
#  RODBC::sqlSave(dbconn, data, tablename = tableName, rownames=FALSE, append = F, fast=T, varTypes = varTypes)
#  RODBC::odbcClose(dbconn)
#  sql = sprintf('ALTER TABLE %s ADD  CONSTRAINT PK_%s PRIMARY KEY CLUSTERED ([dt] ASC ) WITH (PAD_INDEX = OFF, STATISTICS_NORECOMPUTE = OFF, SORT_IN_TEMPDB = OFF, IGNORE_DUP_KEY = OFF, ONLINE = OFF, ALLOW_ROW_LOCKS = ON, ALLOW_PAGE_LOCKS = ON) ON [PRIMARY]',
#                tableName, fredId)
#  result<-sql_query(sql)
#  }
#sql <- paste0('TRUNCATE TABLE [', title,' temp]')
#sql_query(sql)
varTypes <- list(dt = 'Date', title = 'float')
#RODBC::sqlSave(dbconn, data, tablename = paste0(title,' temp'),rownames=FALSE, append = T, fast=T, varTypes = varTypes)
#sql = paste0('delete a from [',title,'] a inner join [',title,' temp] b on a.dt=b.dt;insert into [',title,'] select * from [',title,' temp] ;truncate table [',title,' temp];')
#sql_query(sql)
#RODBC::odbcClose(dbconn)
}
}
eou
sql_sign_in_info <- 'driver={SQL Server};server=desktop-m9e5cke;database=fred_stuff;uid=sakroger;pwd=123'
download_path <-  'C:\\Users\\sakro\\Desktop\\derek\\fred-master\\fred_csv\\'
fred_id_list <- c('T10YIE', 'FEDFUNDS', 'T10Y2Y')
for (fred_id in fred_id_list)
{
fred_data_filename <- paste0(download_path, fred_id,'.csv')
title <- get_title_for_db()
file.remove(fred_data_filename)
download_loop_fred_csv()
data <- format_fred_csv(fred_data_filename)
}
library(fred)
library(fred)
library(readr)
library(RODBC)
library(httr)
library(jsonlite)
sql_sign_in_info <- 'driver={SQL Server};server=desktop-m9e5cke;database=fred_stuff;uid=sakroger;pwd=123'
download_path <-  'C:\\Users\\sakro\\Desktop\\derek\\fred-master\\fred_csv\\'
fred_id_list <- c('T10YIE', 'FEDFUNDS', 'T10Y2Y')
for (fred_id in fred_id_list)
{
fred_data_filename <- paste0(download_path, fred_id,'.csv')
title <- get_title_for_db()
file.remove(fred_data_filename)
download_loop_fred_csv()
data <- format_fred_csv(fred_data_filename)
}
for (fred_id in fred_id_list)
{
fred_data_filename <- paste0(download_path, fred_id,'.csv')
title <- get_title_for_db()
file.remove(fred_data_filename)
download_loop_fred_csv()
data <- format_fred_csv(fred_data_filename)
}
#dbconn <- get_connection()
fred_id_list <- c('FEDFUNDS')
for (fred_id in fred_id_list)
{
fred_data_filename <- paste0(download_path, fred_id,'.csv')
title <- get_title_for_db()
file.remove(fred_data_filename)
download_loop_fred_csv()
data <- format_fred_csv(fred_data_filename)
}
sql_sign_in_info <- 'driver={SQL Server};server=desktop-m9e5cke;database=fred_stuff;uid=sakroger;pwd=123'
download_path <-  'C:\\Users\\sakro\\Desktop\\derek\\fred-master\\fred_csv\\'
fred_id_list <- c('T10YIE', 'FEDFUNDS', 'T10Y2Y')
#dbconn <- get_connection()
fred_id_list <- c('FEDFUNDS')
for (fred_id in fred_id_list)
{
fred_data_filename <- paste0(download_path, fred_id,'.csv')
title <- get_title_for_db()
file.remove(fred_data_filename)
download_loop_fred_csv()
data <- format_fred_csv(fred_data_filename)
}
library(fred)
library(readr)
library(RODBC)
library(httr)
library(jsonlite)
sql_sign_in_info <- 'driver={SQL Server};server=desktop-m9e5cke;database=fred_stuff;uid=sakroger;pwd=123'
download_path <-  'C:\\Users\\sakro\\Desktop\\derek\\fred-master\\fred_csv\\'
fred_id_list <- c('T10YIE', 'FEDFUNDS', 'T10Y2Y')
#dbconn <- get_connection()
fred_id_list <- c('FEDFUNDS')
for (fred_id in fred_id_list)
{
fred_data_filename <- paste0(download_path, fred_id,'.csv')
title <- get_title_for_db()
file.remove(fred_data_filename)
download_loop_fred_csv()
data <- format_fred_csv(fred_data_filename)
}
download_loop_fred_csv <- function()
{
dates_to_download <- release_dates()
number_of_dates <- length(dates_to_download)
for (a in 1:number_of_dates)
{
real_date_early <- dates_to_download[a]
real_date_late <- dates_to_download[a+1]
fred_data_url <- paste0('https://fred.stlouisfed.org/graph/fredgraph.csv?cosd=',real_date_early,'&coed=',real_date_late,'&realtime_start=',real_date_early,'&realtime_end=',real_date_late,'&id=',fred_id)
if (is.na(real_date_late))
{
}
else
{
download.file(fred_data_url, fred_data_filename, quiet = TRUE, mode = 'a')
}
}
}
dates_to_download <- release_dates()
number_of_dates <- length(dates_to_download)
for (a in 1:number_of_dates)
{
real_date_early <- dates_to_download[a]
real_date_late <- dates_to_download[a+1]
fred_data_url <- paste0('https://fred.stlouisfed.org/graph/fredgraph.csv?cosd=',real_date_early,'&coed=',real_date_late,'&realtime_start=',real_date_early,'&realtime_end=',real_date_late,'&id=',fred_id)
if (is.na(real_date_late))
{
}
else
{
download.file(fred_data_url, fred_data_filename, quiet = TRUE, mode = 'a')
}
}
dates_to_download
clc
